---
title: "Signal Exploitation in GNU Radio"
date: "2020-11-12"
categories:
  - "technical"
tags:
  - "adsb"
  - "digital-signals"
  - "diy"
  - "dsp"
  - "gnuradio"
  - "mathematical-modeling"
  - "matlab"
  - "propagation"
coverImage: "splash.png"
---
# Signal Exploitation in GNU Radio

This is a follow-up from my past constructive/destructive interference post, where I actually got to apply some of my theory and signal knowledge to a constructive interference attack. [Code](https://github.com/KE8JCT/Signal_Exploit)

![](https://n2wu.files.wordpress.com/2020/11/splash.png?w=1024)

#### DISCLAIMER

I am operating under the [FCC Part 15 Rule](https://www.ecfr.gov/cgi-bin/text-idx?SID=4a842e3dd5e33e0eedcfa2574d51c0dc&mc=true&node=pt47.1.15&rgn=div5) for my experimental transmitter. I never transmitted more than a few milliwatts and had a range well under 3 meters. Any higher-powered signal contained my callsign at least every 30 seconds.

## Theory

Interference is the mixing of two signals to produce a modulated output signal. This is best explained in pictures:

- ![](https://n2wu.files.wordpress.com/2020/11/picture1.png?w=365)

- ![](https://n2wu.files.wordpress.com/2020/11/picture2.png?w=365)


_Constructive Interference (Left) and Destructive Interference (Right)_

The goal of this project was to eliminate a signal as stated before. Judging by the two images, destructive interference would make more sense for this application initially. However, transmitting the inverse of a signal has intense timing requirements that make it almost impossible for any computational microprocessor. Constructive interference actually has a better chance at distorting the signal - it overly saturates the amplitudes in such a way that the resultant signal is irretrievable.

If used for a PPM signal such as a remote-control device, constructive interference would both saturate the receiver and render any commands incoherent. Additionally, it does not require excess spurious power transmission where destructive interference needs the exact opposite amount.

Constructive Interference also minimizes spectrum signature since it only selectively transmits; a jammer would be active and wide-band at all times.

Overall, my experimental setup looked like the following:

![](https://n2wu.files.wordpress.com/2020/11/capture.png?w=652)

## Implementation

For this implementation, I tried to keep as basic and low-power as possible. For the best chance of decoding and reception, I transmitted FM morse code (Continuous wave) with a microcontroller board on the VHF spectrum. I had a simultaneous transmitter-receiver with the [Ettus E310](https://www.ettus.com/all-products/e310/) within 1m of the microcontroller. I implemented a GNUradio script to launch the constructive interference attack, and recorded the results using an [RTL-SDR](https://www.amazon.com/NooElec-RTL-SDR-RTL2832U-Software-Packages/dp/B008S7AVTC/ref=pd_day0_23_4/144-1833071-1098144?_encoding=UTF8&pd_rd_i=B008S7AVTC&pd_rd_r=e4585ccb-8bb7-420e-9be6-b40aba98c1e1&pd_rd_w=nonQc&pd_rd_wg=Dr1sr&pf_rd_p=dd3b8aec-685a-456e-adb6-ba7e15960b39&pf_rd_r=NK2JTPGJ52KXZF7NEBCK&psc=1&refRID=NK2JTPGJ52KXZF7NEBCK) to a .dat file. I then analyzed the signal in MATLAB.

Initially, I used a [HackRF](https://greatscottgadgets.com/hackrf/one/) with the [PortaPack attachment](https://hackerwarehouse.com/product/portapack-hackrf-one/) to view my signal remotely. However, the interface was a bit tough to use and prone to crashing. Recording the signal with the RTL was _relatively_ pain-free (as explained later) . I followed [these instructions](https://inst.eecs.berkeley.edu/~ee123/sp14/rtl_sdr_install.html) to get set up.

![](https://n2wu.files.wordpress.com/2020/11/img_20201014_1558057922.png?w=1024)

_Testing Setup w/ CW Waterfall Display_

Range is incredibly important in this setup. Power must be kept to a minimum, but the antenna must be at an optimal range for reception, away from near-field effects and metal reflection. An anechoic chamber would be best, but for now a noisy hamshack will do.

Below is the final code I used for the constructive attack.

![](https://n2wu.files.wordpress.com/2020/11/squelch_test.grc-2.png?w=1024)

_Code for CI Attack. Note squelch/gain values_

## Challenges

### Gain

As stated before, _gain_ was the most challenging aspect of this project. I wanted my microcontroller to be close to the receiving antenna and the attacking device, but oversaturating the receiver meant unusable results. Perhaps attenuating the receiver itself (through changing the electric length of the antenna) would lead to decreased antenna gain and better reception. My initial reception of the frequency-modulated, CW signal looked like this:

![](https://n2wu.files.wordpress.com/2020/11/microsoftteams-image-7.png?w=806)

_Initial CW Signal at 20dB Antenna Gain_

Eventually I used the lowest amount of gain on the antenna, 0dB. It gave me a usable signal shown below. To capture it I used this command on the CMD line on my PC:

```
rtl_sdr -f 146570000 -n 16000000 -s 3200000 -g 0.0 data.dat
```

![](https://n2wu.files.wordpress.com/2020/11/microsoftteams-image-8.png?w=1024)

_FM Morse Code!_

After this, I was able to get readable results.

### E310 Transmission

Using the E310 was such a pain until it eventually worked. Our issue involved software versions between our internet machine (an intel NUC) and the UHD software on the Ettus. Code on the E310 must actually be compiled, so the programmer has to build programs on a separate computer, generate the python file, and move it over to the networked Ettus. As a test I made a standard cosine wave, then a repeater to show that my device was working. I still had the same conditions for transmission where I was transmitting extremely low power within 1 meter.

![](https://n2wu.files.wordpress.com/2020/11/microsoftteams-image-9.png?w=1024)

_Cosine Wave from Ettus_

![](https://n2wu.files.wordpress.com/2020/11/2.png?w=387)

_Repeater Function from ID'ed CW Message_

## Results

Once I figured out the gain variables on the **squelch**, **source**, **threshold**, and **sink** blocks, I was able to control my interference selectively. I moved the transmit frequency down to the same frequency as the microcontroller and recorded the results. Below are several graphs to show the difference between the control signal (without interference) and the test signal (with interference).

The control signal is identical to the test signal except it lacks any sort of interference. It was still subject to path loss and atmospheric noise, and recorded with the same gain as the test signal.

![](https://n2wu.files.wordpress.com/2020/11/raw-1.png?w=1024)

_Raw input from receiver for 10-second sample. Note the change in amplitude and pattern._

After finding the raw signal, I used a matched filter to isolate my cw signal. Surprisingly, with frequency modulation, the morse code portions are the signals with a relative amplitude closer to zero. They have a lower frequency than the spurious emissions - the higher and lower amplitudes.

![](https://n2wu.files.wordpress.com/2020/11/filtered.png?w=840)

_Filter for CW and exploited signal_

The filter used in this experiment completely failed to recognize a usable pattern with the test signal.

![](https://n2wu.files.wordpress.com/2020/11/fft.png?w=1024)

_FFT of Both Signals_

Lastly, a FFT for both signals confirmed what was shown in the previous two; the test signal has no discernable qualities. Therefore it cannot be decoded, and the experiment was successful with the parameters I put in.

## UPDATE: 12NOV

I ran the control and experimental tests again to see any variation. It still looks like my code needs work. The raw signals look promising:

![](https://n2wu.files.wordpress.com/2020/11/raw-2.png?w=1024)

_Raw Data for Experiment_

But the filter seems to work just the same on both frequencies. However, CW is easily recognizable. With PPM, 1's and 0's are subject to greater standards; they must remain within a decibel limit and have a specified duration. Those standards do not exist for CW.

![](https://n2wu.files.wordpress.com/2020/11/filtered-1.png?w=1024)

_Filtered Output_

The FFT of the signals did not yield anything significant. Here are the three plots overlaid:

![](https://n2wu.files.wordpress.com/2020/11/overlay.png?w=1024)

_Overlay Plots_

You can clearly see the presence of a noisy signal, but not much else has changed with it. It is still able to be decoded by sight. Perhaps a PPM implementation will have more success.

## Conclusion

A constructive interference test was created on CW signals for a remote-control pulse-position modulation (PPM) implementation. The experimental setup used GNUradio and an Ettus E-310 to successfully limit decoding of a test beacon signal.

In future tests, I will play around with the gain more to find a custom-tailored result. Even further, I may use an algorithm described in a previous post on ADS-B transmission to dynamically change my threshold values since ADS-B has multiple inputs.

Lastly, I will perform more than a subjective analysis on the transmission. I want to perform a bit-error analysis (BER) as described previously, but am having trouble decoding the FM CW signal through matlab. For future experiments, I plan on synthesizing my own PPM signal and transmitting it through a HackRF instead of the microcontroller. Then, the Ettus will easily be able to intercept and interfere with the signal. Using matlab I will actually be able to determine what percent of bits were intercepted.

Overall this project was incredibly intensive and _constructive_ to the theory behind interferences with a detailed, multidisciplined coding application!
